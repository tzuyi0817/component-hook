import{r as A,i as _,j,d as R,k as ne,a as Y,o as E,e as V,F as B,l as W,n as q,u as k,t as x,p as oe,c as L,T as se,b as G,q as K,w as X,s as Z,v as J,x as z,h as P,y as ae,z as le,A as re}from"./index-BJRSzs8R.js";const ie=Array.isArray;function ce(e,t){if(te(e))return"multiple";const[a]=e;return a!=null&&a[t.children]?"cascade":"single"}function ue(e){return{children:(e==null?void 0:e.children)||"children",label:(e==null?void 0:e.label)||"label",value:(e==null?void 0:e.value)||"value"}}function de(e,t,a){var i;if(te(e))return[];const s=[];let n=e,o=0;for(;n;){const f=t[o];let u=ee(n,f,a);u===-1&&(u=0),s.push(n),o+=1,n=(i=n[u])==null?void 0:i[a.children]}return s}function fe(e,t,a,s){const n=[...a];let o=e,i=t+1;for(;o!=null&&o[s.children];){const f=o[s.children][0];n[i]=f.value,o=f,i+=1}return n}function ee(e,t,a){return e.findIndex(s=>(s==null?void 0:s[a.value])===t)}function te(e){const[t]=e;return ie(t)}function me(e,t){return e>t?"horizontal":t>e?"vertical":""}function Ye(e,t,a){const s=[];for(let n=e;n<=t;n++){const o=a(`${n}`);s.push({label:o,value:n})}return s}function Oe(e,t){return e===t.getFullYear()}function Ae(e,t){return e===t.getFullYear()}function Pe(e,t){return e===t.getMonth()+1}function xe(e,t){return e===t.getMonth()+1}function $e(e,t){return new Date(e,t,0).getDate()}function Ne(e,t,a){const s=new Date,n=Date.now(),o=e.getTime(),i=t.getTime(),f=n>=o&&n<=i;return a==="year"?f?s.getFullYear():e.getFullYear():a==="month"?f?s.getMonth()+1:e.getMonth()+1:f?s.getDate():e.getDate()}function Fe(e){return e}function pe(e){return/^(?:[01]\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e)}function Be(e){if(!pe(e))return null;const[t,a,s]=e.split(":");return{hour:Number(t),minute:Number(a),second:Number(s)}}function Le(e){return e.padStart(2,"0")}function Xe(e,t,a){const s=Date.now(),{hour:n,minute:o,second:i}=e,{hour:f,minute:u,second:c}=t,g=new Date().setHours(n,o,i),w=new Date().setHours(f,u,c),M=s>=g&&s<=w;return a==="hour"?M?new Date().getHours():n:a==="minute"?M?new Date().getMinutes():o:M?new Date().getSeconds():i}const ke=16,$=48,he=.52,Q=150,F=300,ve=15,ge=.008,ze="Select Date",Re=["year","month","day"],Ue="Select Time",He=["hour","minute","second"];function Te(){const e={startX:0,startY:0,deltaX:0,deltaY:0,offsetX:0,offsetY:0};let t="";const a=()=>t==="vertical",s=()=>t==="horizontal";function n(){e.deltaX=0,e.deltaY=0,e.offsetX=0,e.offsetY=0,t=""}function o(u){const c="touches"in u?u.touches[0]:u;n(),e.startX=c.clientX,e.startY=c.clientY}function i(u){if(!e.startX||!e.startY)return!0;const c="touches"in u?u.touches[0]:u;e.deltaX=Math.max(c.clientX,0)-e.startX,e.deltaY=c.clientY-e.startY,e.offsetX=Math.abs(e.deltaX),e.offsetY=Math.abs(e.deltaY);const g=10;(!t||e.offsetX<g&&e.offsetY<g)&&(t=me(e.offsetX,e.offsetY))}function f(){e.startX=0,e.startY=0}return{pointer:e,move:i,start:o,stop:f,reset:n,isVertical:a,isHorizontal:s}}function be({column:e,onChange:t}){const s=Number.parseFloat(getComputedStyle(document.documentElement).fontSize)/ke,n=A(0),o=A(0),{pointer:i,start:f,move:u,stop:c}=Te();let g=0,w=0,M=0,D=!1,S=null;function T(d){f(d),D=!0,o.value=0,w=Date.now(),g=n.value,M=g,S=null}function m(d){if(u(d))return;const y=j(e)?e.value.length:e.length,O=g+i.deltaY,N=h((y-1)*-$),U=Math.min(Math.max(O,N),0),H=Date.now();n.value=U,!(H-w<=F)&&(w=H,M=U)}function r(){c();const d=n.value-M,v=Date.now()-w;if(v<F&&Math.abs(d)>ve){l(d,v);return}const y=I(n.value);o.value=Q,b(y),D=!1}function l(d,v){const y=Math.abs(d/v),O=n.value+y/ge*(d<0?-1:1),N=I(O);o.value=F,b(N)}function p(){o.value=0,D=!1,S&&(S(),S=null)}function b(d){const v=-d*h($),y=()=>t==null?void 0:t(d);D&&v!==n.value?S=y:y(),n.value=v}function I(d){const v=j(e)?e.value.length:e.length,y=Math.round(-d/h($));return y<0?0:y>=v?v-1:y}function h(d){return d*s}function C(d,v="auto"){D&&v==="smooth"||(S=null,D=v==="smooth",o.value=v==="smooth"?Q:0,b(d))}return{offsetY:_(n),transitionDuration:_(o),onPointerDown:T,onPointerMove:m,onPointerUp:r,stopInertialSliding:p,scrollToIndex:C}}const we=["onClick"],ye=R({__name:"PickerColumn",props:{column:{},fields:{},selectedIndex:{default:0}},emits:["change"],setup(e,{expose:t,emit:a}){const s=e,n=a,{offsetY:o,transitionDuration:i,onPointerDown:f,onPointerMove:u,onPointerUp:c,stopInertialSliding:g,scrollToIndex:w}=be({column:ne(s,"column"),onChange:M});function M(T){T!==s.selectedIndex&&n("change",T)}function D(T=s.selectedIndex,m){w(T,m)}function S(T){T!==s.selectedIndex&&D(T,"smooth")}return t({scrollToSelected:D}),(T,m)=>(E(),Y("div",{class:"chook-picker-column",onTouchstartPassive:m[1]||(m[1]=(...r)=>k(f)&&k(f)(...r)),onTouchmovePassive:m[2]||(m[2]=(...r)=>k(u)&&k(u)(...r)),onTouchendPassive:m[3]||(m[3]=(...r)=>k(c)&&k(c)(...r)),onTouchcancel:m[4]||(m[4]=(...r)=>k(c)&&k(c)(...r)),onMousedownPassive:m[5]||(m[5]=(...r)=>k(f)&&k(f)(...r)),onMousemovePassive:m[6]||(m[6]=(...r)=>k(u)&&k(u)(...r)),onMouseupPassive:m[7]||(m[7]=(...r)=>k(c)&&k(c)(...r))},[V("ul",{style:q({overflowY:"hidden",transform:`translate3d(0, ${k(o)}px, 0)`,transitionDuration:`${k(i)}ms`,transitionProperty:k(i)?"all":"none"}),onTransitionend:m[0]||(m[0]=(...r)=>k(g)&&k(g)(...r))},[(E(!0),Y(B,null,W(T.column,(r,l)=>(E(),Y("li",{key:r==null?void 0:r[T.fields.value],class:"chook-picker-column-item",role:"button",tabindex:"0",onClick:p=>S(l)},[V("p",{class:"chook-picker-column-label",style:q({transform:`rotate3d(1, 0, 0, ${(l*k($)+k(o))*k(he)}deg)`})},x(r==null?void 0:r[T.fields.label]),5)],8,we))),128))],36)],32))}}),De={class:"chook-picker-container"},Ie=R({__name:"Popup",props:{teleport:{default:"body"},modelValue:{type:Boolean}},emits:["update:modelValue","open","close","closed"],setup(e,{emit:t}){const a=e,s=t;return oe(()=>a.modelValue,n=>{n?(document.body.style.overflow="hidden",s("open")):(document.body.style.overflow="",s("close"))},{immediate:!0}),(n,o)=>(E(),L(se,{to:n.teleport},[G(K,{name:"chook-picker-fade"},{default:X(()=>[Z(V("div",{class:"chook-picker-mask",onClick:o[0]||(o[0]=i=>n.$emit("update:modelValue",!1))},null,512),[[J,n.modelValue]])]),_:1}),G(K,{name:"chook-picker-slide",onAfterLeave:o[1]||(o[1]=i=>n.$emit("closed"))},{default:X(()=>[Z(V("div",De,[z(n.$slots,"default")],512),[[J,n.modelValue]])]),_:3})],8,["to"]))}}),Me={class:"chook-picker-header"},Se={class:"chook-picker-title"},Ve={class:"chook-picker-loading"},Ce={key:1,class:"chook-picker-columns"},_e=R({__name:"Picker",props:{show:{type:Boolean},modelValue:{},title:{},columns:{},linkage:{type:Boolean},loading:{type:Boolean},teleport:{},confirmButtonText:{default:"Confirm"},cancelButtonText:{default:"Cancel"},columnsFieldNames:{}},emits:["update:show","update:modelValue","confirm","cancel","open","closed"],setup(e,{emit:t}){const a=e,s=t,n=A([]),o=A([]),i=A([]),f=A(null),u=P({get:()=>a.show,set:l=>s("update:show",l)}),c=P(()=>ue(a.columnsFieldNames)),g=P(()=>ce(a.columns,c.value)),w=P(()=>{const{columns:l}=a;return g.value==="single"?[l]:g.value==="multiple"?l:de(l,o.value,c.value)});function M(l,p){var d;const b=w.value[l],I=(d=b[p])==null?void 0:d[c.value.value],h=o.value[l];if(I===h)return;const C=[...o.value];if(C[l]=I,g.value==="cascade"){const v=b[p];o.value=fe(v,l,C,c.value)}else o.value=C;a.linkage&&D()}function D(){s("update:modelValue",o.value),n.value=o.value}function S(){s("update:show",!1)}async function T(){s("open"),await re(),o.value=a.modelValue?[...a.modelValue]:[...n.value]}function m(){a.linkage||D(),S(),s("confirm",o.value)}function r(){S(),s("cancel")}return ae(()=>{var b,I;const l=w.value.length,p=[];for(let h=0;h<l;h++){const C=w.value[h],d=o.value[h],v=ee(C,d,c.value);if(v===-1){const O=(i.value[h]??0)>=C.length?Math.max(C.length-1,0):0;o.value[h]=(b=C[O])==null?void 0:b[c.value.value],p[h]=O}else p[h]=v;p[h]!==i.value[h]&&((I=f.value)==null||I[h].scrollToSelected(p[h]))}i.value=p}),(l,p)=>(E(),L(Ie,{modelValue:u.value,"onUpdate:modelValue":p[1]||(p[1]=b=>u.value=b),teleport:l.teleport,onOpen:T,onClosed:p[2]||(p[2]=b=>l.$emit("closed"))},{default:X(()=>[V("div",Me,[V("button",{class:"chook-picker-cancel",onClick:r},x(l.cancelButtonText),1),V("p",Se,x(l.title),1),V("button",{class:"chook-picker-confirm",onClick:m},x(l.confirmButtonText),1)]),l.loading?(E(),Y(B,{key:0},[V("div",Ve,[z(l.$slots,"loading")]),p[3]||(p[3]=V("div",{class:"chook-picker-columns"},null,-1))],64)):l.columns.length?(E(),Y("div",{key:2,class:"chook-picker-columns chook-picker-columns-backdrop",onTouchmove:p[0]||(p[0]=le(()=>{},["stop"]))},[(E(!0),Y(B,null,W(w.value,(b,I)=>(E(),L(ye,{key:I,ref_for:!0,ref_key:"columnsRef",ref:f,column:b,fields:c.value,"selected-index":i.value[I],onChange:h=>M(I,h)},null,8,["column","fields","selected-index","onChange"]))),128)),p[4]||(p[4]=V("div",{class:"chook-picker-mask-backdrop"},null,-1))],32)):(E(),Y("div",Ce,[z(l.$slots,"empty")]))]),_:3},8,["modelValue","teleport"]))}}),je="#### CSS Variables\n\n| Name                                | Default Value                                                                                                                                                         |\n| :---------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| --chook-picker-background           | `#fff`                                                                                                                                                                |\n| --chook-picker-border-radius        | `0.5rem`                                                                                                                                                              |\n| --chook-picker-padding-bottom       | `1.25rem`                                                                                                                                                             |\n| --chook-picker-z-index              | `2147483646`                                                                                                                                                          |\n| --chook-picker-mask-background      | `rgba(0, 0, 0, 0.2)`                                                                                                                                                  |\n| --chook-picker-header-padding       | `0.75rem 0`                                                                                                                                                           |\n| --chook-picker-header-margin-bottom | `1.25rem`                                                                                                                                                             |\n| --chook-picker-title-font-size      | `1rem`                                                                                                                                                                |\n| --chook-picker-title-font-weight    | `500`                                                                                                                                                                 |\n| --chook-picker-title-color          | `#323233`                                                                                                                                                             |\n| --chook-picker-title-padding        | `0 1rem`                                                                                                                                                              |\n| --chook-picker-confirm-color        | `#1989fa`                                                                                                                                                             |\n| --chook-picker-confirm-font-size    | `0.875rem`                                                                                                                                                            |\n| --chook-picker-confirm-padding      | `0 1rem 0 0`                                                                                                                                                          |\n| --chook-picker-cancel-color         | `#969799`                                                                                                                                                             |\n| --chook-picker-cancel-font-size     | `0.875rem`                                                                                                                                                            |\n| --chook-picker-cancel-padding       | `0 0 0 1rem`                                                                                                                                                          |\n| --chook-picker-active-opacity       | `0.6`                                                                                                                                                                 |\n| --chook-picker-columns-margin       | `0 1rem`                                                                                                                                                              |\n| --chook-picker-columns-backdrop     | `linear-gradient(to bottom, #f2f2f2 0px, #f2f2f2 0.0625rem, transparent 0.0625rem, transparent calc(100% - 0.0625rem), #f2f2f2 calc(100% - 0.0625rem), #f2f2f2 100%)` |\n| --chook-picker-mask-backdrop        | `linear-gradient(180deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.4)), linear-gradient(0deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.4))`              |\n| --chook-picker-column-label-color   | `#323233`                                                                                                                                                             |\n| --chook-picker-column-label-padding | `0 0.25rem`                                                                                                                                                           |\n| --chook-picker-column-font-size     | `1rem`                                                                                                                                                                |\n| --chook-picker-column-font-weight   | `500`                                                                                                                                                                 |\n",qe="### Installation\n\n::: group\n\n```bash [npm]\n$ npm install @component-hook/picker\n```\n\n```bash [yarn]\n$ yarn add @component-hook/picker\n```\n\n```bash [pnpm]\n$ pnpm install @component-hook/picker\n```\n\n:::\n";export{Re as D,_e as _,ze as a,Oe as b,je as c,Ae as d,Pe as e,Fe as f,Ye as g,xe as h,qe as i,$e as j,Ne as k,Le as l,He as m,Ue as n,Be as o,Xe as p};
